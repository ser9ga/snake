(this.webpackJsonpsnake=this.webpackJsonpsnake||[]).push([[0],{18:function(e,r,n){},19:function(e,r,n){"use strict";n.r(r);var t=n(2),a=n.n(t),i=n(11),c=n.n(i),o=n(12),s=n(6),u=n(0),d=n(3),l=n(7),b=n.n(l),j=n(4),O=n.n(j),f=n(1),p=function(e){var r=e.isFilled;return Object(f.jsx)("div",{className:"".concat(O.a.squareWrapper),children:Object(f.jsx)("div",{className:"".concat(O.a.square," ").concat(r&&O.a.filledSquare),children:Object(f.jsx)("div",{className:"".concat(O.a.innerSquare," ").concat(r&&O.a.filledInnerSquare)})})})},x=Object(t.memo)(p),y=n(9),v=n.n(y),m=function(e){var r=e.screen,n=e.fieldSize;return Object(f.jsx)("div",{className:v.a.screen,children:Object(f.jsx)("div",{className:v.a.screenFrame,children:Object(d.a)(Array(n.y)).map((function(e,t){return Object(f.jsx)("div",{className:v.a.rowLine,children:Object(d.a)(Array(n.x)).map((function(e,a){var i=n.x*t+a;return Object(f.jsx)(x,{isFilled:r[i].isFilled},"".concat(a,"_").concat(t))}))},t)}))})})},h=Object(t.memo)(m),S=function(e){var r=e.dispatchSnakeState;return Object(t.useEffect)((function(){return document.addEventListener("keydown",(function(e){return r({type:"keyPressHandler",payload:e})})),function(){document.removeEventListener("keydown",(function(e){return r({type:"keyPressHandler",payload:e})}))}}),[]),Object(f.jsx)("div",{})};var _=function(){var e=Object(t.useMemo)((function(){return{x:20,y:20}}),[]),r=[{x:4,y:5,isFilled:!1,isTarget:!1},{x:5,y:5,isFilled:!0,isTarget:!1},{x:6,y:5,isFilled:!0,isTarget:!1},{x:7,y:5,isFilled:!0,isTarget:!1}],n=Object(t.useMemo)((function(){return Object(d.a)(Array(e.y)).flatMap((function(r,n){return Object(d.a)(Array(e.x)).map((function(e,r){return{x:r,y:n,isFilled:!1,isTarget:!1}}))}))}),[e]),a=Object(t.useMemo)((function(){return n.reduce((function(r,n){return 0===n.x||n.x===e.x-1||0===n.y||n.y===e.y-1?r.concat(Object(u.a)(Object(u.a)({},n),{},{isFilled:!0})):r}),[])}),[e]),i=function(r,n){var t=Object(d.a)(r);return n.forEach((function(r){return t[e.x*r.y+r.x]=r})),t},c=function(e){var r=Object(u.a)({},e),n=r.body,t=n[0].isFilled?{}:n.shift();n[0].isFilled=!0;var a=r.currentDirection.ax===r.nextDirection.ax?"currentDirection":"nextDirection",i="horizontal"===r[a].ax?"x":"y",c=Object(u.a)({},n[n.length-1]),o=function(r){var n;return Object(u.a)(Object(u.a)({},r),{},(n={},Object(s.a)(n,i,"forward"===e[a].dir?r[i]+1:r[i]-1),Object(s.a)(n,"isTarget",!1),n))},d=o(c);return{filteredBodyState:n,direction:a,currenHead:c,cutTail:t,getNextBodyPixel:o,newHead:d}},l=function(r,n){var t=Object(d.a)(r);n.forEach((function(r){t.splice([e.x*r.y+r.x],1)}));var a=t.filter((function(e){return!e.isFilled}));return Object(u.a)(Object(u.a)({},a[Math.floor(Math.random()*a.length)]),{},{isFilled:!0,isTarget:!0})},j={isGameRunning:!1,isMatchIsOn:!1,isGameOver:!1,body:[].concat(r),screen:i(n,a),currentDirection:{dir:"forward",ax:"horizontal"},nextDirection:{dir:"forward",ax:"horizontal"}},O=Object(t.useReducer)((function(n,t){if("setSnakeState"===t.type)return Object(u.a)(Object(u.a)({},n),t.payload);if("prepareAndExecNewTurn"===t.type){var a=c(n),o=a.filteredBodyState,s=a.direction,b=a.cutTail,O=a.newHead,f=Object(u.a)({},n.screen[e.x*O.y+O.x]);if(f.isFilled&&!f.isTarget)return Object(u.a)(Object(u.a)({},n),{},{isGameRunning:!1,isMatchIsOn:!1,isGameOver:!0,currentDirection:{dir:"forward",ax:"horizontal"},nextDirection:{dir:"forward",ax:"horizontal"}});var p=Object(d.a)(o);f.isTarget&&p.splice(1,0,Object(u.a)(Object(u.a)({},p[0]),{},{isFilled:!1})),p=p.map((function(e,r){return 0===r?Object(u.a)(Object(u.a)({},e),{},{isFilled:!1}):e})).concat(O);var x=i(n.screen,p);f.isTarget&&(x=i(x,[l(x,[b])]));var y=n[s];return Object(u.a)(Object(u.a)({},n),{},{screen:x,body:p,currentDirection:y})}if("setTargetPixelOnStart"===t.type){var v=c(n).newHead,m=l(n.screen,[].concat(r,[v])),h=i(n.screen,[m]);return Object(u.a)(Object(u.a)({},n),{},{screen:h})}if("keyPressHandler"===t.type){t.payload.preventDefault();var S={ArrowLeft:{dir:"backward",ax:"horizontal"},ArrowRight:{dir:"forward",ax:"horizontal"},ArrowUp:{dir:"backward",ax:"vertical"},ArrowDown:{dir:"forward",ax:"vertical"},KeyA:{dir:"backward",ax:"horizontal"},KeyD:{dir:"forward",ax:"horizontal"},KeyW:{dir:"backward",ax:"vertical"},KeyS:{dir:"forward",ax:"vertical"}}[t.payload.code];return(n.nextDirection.dir!==(null===S||void 0===S?void 0:S.dir)||n.nextDirection.ax!==(null===S||void 0===S?void 0:S.ax))&&S&&n.isGameRunning?Object(u.a)(Object(u.a)({},n),{},{nextDirection:S}):"Space"===t.payload.code?Object(u.a)(Object(u.a)({},n),{},{isGameRunning:!n.isGameRunning,isMatchIsOn:!0}):"Backspace"===t.payload.code?j:n}return new Error}),j),p=Object(o.a)(O,2),x=p[0],y=p[1],v=Object(t.useRef)(),m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:500;v.current||(v.current=setInterval((function(){return y({type:"prepareAndExecNewTurn"})}),e))},_=function(){v.current&&(clearInterval(v.current),v.current=null)};return Object(t.useEffect)((function(){x.isGameRunning&&m(),x.isGameRunning||_()}),[x.isGameRunning]),Object(f.jsxs)("div",{className:b.a.App,children:[Object(f.jsx)(h,{screen:x.screen,fieldSize:e}),Object(f.jsxs)("div",{className:b.a.buttonPanel,children:[Object(f.jsx)("button",{className:b.a.button,onClick:function(){var e=x.isMatchIsOn,t=x.isGameRunning,c=x.isGameOver,o=x.body,s=x.screen;y({type:"setSnakeState",payload:{isGameOver:!1,isMatchIsOn:!0,isGameRunning:!t,screen:e?s:i(n,[].concat(Object(d.a)(a),r)),body:c?Object(d.a)(j.body):o}}),!e&&y({type:"setTargetPixelOnStart"})},children:x.isGameRunning?"Pause":"Start"}),Object(f.jsx)("button",{className:b.a.button,onClick:function(){var e=x.isGameRunning,t=x.isGameOver,c=e||t,o=c?{isGameRunning:!0,isMatchIsOn:!0,screen:i(n,[].concat(Object(d.a)(a),r))}:{};c&&_(),y({type:"setSnakeState",payload:Object(u.a)(Object(u.a)({},j),o)}),(e||t)&&y({type:"setTargetPixelOnStart"}),c&&m()},children:"Reset"})]}),Object(f.jsx)(S,{dispatchSnakeState:y})]})};n(18);c.a.render(Object(f.jsx)(a.a.StrictMode,{children:Object(f.jsx)(_,{})}),document.getElementById("root"))},4:function(e,r,n){e.exports={squareWrapper:"Square_squareWrapper__1-5jq",square:"Square_square__5MeBN",filledSquare:"Square_filledSquare__3nVrd",innerSquare:"Square_innerSquare__1V41H",filledInnerSquare:"Square_filledInnerSquare__3sDlX"}},7:function(e,r,n){e.exports={App:"App_App__16ZpL",buttonPanel:"App_buttonPanel__24-jo",button:"App_button__13pio"}},9:function(e,r,n){e.exports={App:"Screen_App__28xjI",screen:"Screen_screen__Q0lyG",screenFrame:"Screen_screenFrame__BXMp8",rowLine:"Screen_rowLine__1HFM3"}}},[[19,1,2]]]);
//# sourceMappingURL=main.d2594307.chunk.js.map