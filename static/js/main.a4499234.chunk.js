(this.webpackJsonpsnake=this.webpackJsonpsnake||[]).push([[0],{10:function(e,r,t){e.exports={App:"Screen_App__28xjI",screen:"Screen_screen__Q0lyG",screenFrame:"Screen_screenFrame__BXMp8",rowLine:"Screen_rowLine__1HFM3"}},21:function(e,r,t){},22:function(e,r,t){"use strict";t.r(r);var n=t(2),a=t.n(n),c=t(13),i=t.n(c),s=t(7),o=t.n(s),u=t(3),l=t(4),d=t.n(l),b=t(1),j=function(e){var r=e.isFilled;return Object(b.jsx)("div",{className:"".concat(d.a.squareWrapper),children:Object(b.jsx)("div",{className:"".concat(d.a.square," ").concat(r&&d.a.filledSquare),children:Object(b.jsx)("div",{className:"".concat(d.a.innerSquare," ").concat(r&&d.a.filledInnerSquare)})})})},O=Object(n.memo)(j),f=t(10),p=t.n(f),x=function(e){var r=e.screen,t=e.fieldSize;return Object(b.jsx)("div",{className:p.a.screen,children:Object(b.jsx)("div",{className:p.a.screenFrame,children:Object(u.a)(Array(t.y)).map((function(e,n){return Object(b.jsx)("div",{className:p.a.rowLine,children:Object(u.a)(Array(t.x)).map((function(e,a){var c=t.x*n+a;return Object(b.jsx)(O,{isFilled:r[c].isFilled},"".concat(a,"_").concat(n))}))},n)}))})})},v=Object(n.memo)(x),m=function(e){var r=e.keyPressHandler,t=function(e){return r(e)};return Object(n.useEffect)((function(){return document.addEventListener("keydown",t),function(){document.removeEventListener("keydown",t)}}),[]),Object(b.jsx)("div",{})},y=t(8),h=t.n(y),_=t(12),w=t(14),g=t(6),S=t(0),G=function(){var e=Object(n.useRef)(),r=Object(n.useMemo)((function(){return{x:20,y:20}}),[]),t=Object(u.a)(Array(4)).map((function(e,r){return{x:r+4,y:5,isFilled:!!r,isTarget:!1}})),a=Object(n.useMemo)((function(){return Object(u.a)(Array(r.y)).flatMap((function(e,t){return Object(u.a)(Array(r.x)).map((function(e,r){return{x:r,y:t,isFilled:!1,isTarget:!1}}))}))}),[r]),c=Object(n.useMemo)((function(){return a.reduce((function(e,t){return 0===t.x||t.x===r.x-1||0===t.y||t.y===r.y-1?e.concat(Object(S.a)(Object(S.a)({},t),{},{isFilled:!0})):e}),[])}),[r]),i=function(e,t){var n=Object(u.a)(e);return t.forEach((function(e){return n[r.x*e.y+e.x]=e})),n},s={restartFlag:!1,isGameRunning:!1,isMatchIsOn:!1,isGameOver:!1,body:Object(u.a)(t),screen:i(a,c),currentDirection:{dir:"forward",ax:"horizontal"},nextDirection:{dir:"forward",ax:"horizontal"}},o=function(e){var r=Object(S.a)({},e),t=r.body,n=t[0].isFilled?{}:t.shift();t[0].isFilled=!0;var a=r.currentDirection.ax===r.nextDirection.ax?"currentDirection":"nextDirection",c="horizontal"===r[a].ax?"x":"y",i=Object(S.a)({},t[t.length-1]),s=function(r){var t;return Object(S.a)(Object(S.a)({},r),{},(t={},Object(g.a)(t,c,"forward"===e[a].dir?r[c]+1:r[c]-1),Object(g.a)(t,"isTarget",!1),t))},o=s(i);return{filteredBodyState:t,direction:a,currenHead:i,cutTail:n,getNextBodyPixel:s,newHead:o}},l=function(e,t){var n=Object(u.a)(e);t.forEach((function(e){n.splice([r.x*e.y+e.x],1)}));var a=n.filter((function(e){return!e.isFilled}));return Object(S.a)(Object(S.a)({},a[Math.floor(Math.random()*a.length)]),{},{isFilled:!0,isTarget:!0})},d=function(e){var r=o(e).newHead,n=l(e.screen,[].concat(Object(u.a)(t),[r]));return{screen:i(e.screen,[n])}},b=Object(n.useReducer)((function(e,n){if("prepareAndExecNewTurn"===n.type){var b=o(e),j=b.filteredBodyState,O=b.direction,f=b.cutTail,p=b.newHead,x=Object(S.a)({},e.screen[r.x*p.y+p.x]);if(x.isFilled&&!x.isTarget)return Object(S.a)(Object(S.a)({},e),{},{isGameRunning:!1,isMatchIsOn:!1,isGameOver:!0,currentDirection:{dir:"forward",ax:"horizontal"},nextDirection:{dir:"forward",ax:"horizontal"}});var v=Object(u.a)(j);x.isTarget&&v.splice(1,0,Object(S.a)(Object(S.a)({},v[0]),{},{isFilled:!1})),v=v.map((function(e,r){return 0===r?Object(S.a)(Object(S.a)({},e),{},{isFilled:!1}):e})).concat(p);var m=i(e.screen,v);x.isTarget&&(m=i(m,[l(m,[f])]));var y=e[O];return Object(S.a)(Object(S.a)({},e),{},{screen:m,body:v,currentDirection:y})}if("keyPressHandler"===n.type){n.payload.preventDefault();var h={ArrowLeft:{dir:"backward",ax:"horizontal"},ArrowRight:{dir:"forward",ax:"horizontal"},ArrowUp:{dir:"backward",ax:"vertical"},ArrowDown:{dir:"forward",ax:"vertical"},KeyA:{dir:"backward",ax:"horizontal"},KeyD:{dir:"forward",ax:"horizontal"},KeyW:{dir:"backward",ax:"vertical"},KeyS:{dir:"forward",ax:"vertical"}}[n.payload.code];return(e.nextDirection.dir!==(null===h||void 0===h?void 0:h.dir)||e.nextDirection.ax!==(null===h||void 0===h?void 0:h.ax))&&h&&e.isGameRunning?Object(S.a)(Object(S.a)({},e),{},{nextDirection:h}):e}if("startOrPause"===n.type){var _=e.isGameRunning,w=e.isMatchIsOn,g=e.isGameOver,G=e.body,F=e.screen,k=Object(S.a)(Object(S.a)({},e),{},{isGameOver:!1,isMatchIsOn:!0,isGameRunning:!_,screen:w?F:i(a,[].concat(Object(u.a)(c),Object(u.a)(t))),body:g?Object(u.a)(s.body):G});return Object(S.a)(Object(S.a)({},k),!w&&d(k))}if("resetHandler"===n.type){var q=e.restartFlag,A=e.isGameRunning,R=e.isMatchIsOn,D=e.isGameOver,I={isGameRunning:!(R||!D)||A,isMatchIsOn:!!q||D},M=q||D?{screen:i(a,[].concat(Object(u.a)(c),Object(u.a)(t)))}:{},P=Object(S.a)(Object(S.a)(Object(S.a)(Object(S.a)(Object(S.a)({},e),s),I),M),{},{restartFlag:q});return Object(S.a)(Object(S.a)({},P),(q&&R||D)&&d(P))}return"stopInterval"===n.type?Object(S.a)(Object(S.a)({},e),{},{restartFlag:e.isGameRunning||e.isGameOver,isGameRunning:!1}):"startInterval"===n.type?Object(S.a)(Object(S.a)({},e),{},{restartFlag:!1,isGameRunning:e.restartFlag}):new Error}),s),j=Object(w.a)(b,2),O=j[0],f=j[1],p=function(){var e=Object(_.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f({type:"stopInterval"});case 2:return e.next=4,f({type:"resetHandler"});case 4:return e.next=6,f({type:"startInterval"});case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),x=function(){var e=Object(_.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f({type:"startOrPause"});case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){O.isGameRunning&&(e.current=setInterval((function(){return f({type:"prepareAndExecNewTurn"})}),200)),O.isGameRunning||(clearInterval(e.current),e.current=null)}),[O.isGameRunning]),{fieldSize:r,snakeState:O,startOrPauseGame:x,resetGame:p,keyPressHandler:function(e){e.preventDefault(),f({type:"keyPressHandler",payload:e}),"Space"===e.code&&x(),"Backspace"===e.code&&p()}}},F=function(){var e=G(),r=e.fieldSize,t=e.snakeState,n=e.startOrPauseGame,a=e.resetGame,c=e.keyPressHandler;return Object(b.jsxs)("div",{className:o.a.App,children:[Object(b.jsx)(v,{screen:t.screen,fieldSize:r}),Object(b.jsxs)("div",{className:o.a.buttonPanel,children:[Object(b.jsx)("button",{className:o.a.button,onClick:n,children:t.isGameRunning||t.restartFlag?"Pause":"Start"}),Object(b.jsx)("button",{className:o.a.button,onClick:a,children:"Reset"})]}),Object(b.jsx)(m,{keyPressHandler:c})]})};t(21);i.a.render(Object(b.jsx)(a.a.StrictMode,{children:Object(b.jsx)(F,{})}),document.getElementById("root"))},4:function(e,r,t){e.exports={squareWrapper:"Square_squareWrapper__1-5jq",square:"Square_square__5MeBN",filledSquare:"Square_filledSquare__3nVrd",innerSquare:"Square_innerSquare__1V41H",filledInnerSquare:"Square_filledInnerSquare__3sDlX"}},7:function(e,r,t){e.exports={App:"App_App__16ZpL",buttonPanel:"App_buttonPanel__24-jo",button:"App_button__13pio"}}},[[22,1,2]]]);
//# sourceMappingURL=main.a4499234.chunk.js.map